
## 标准
1. 99.9% 99.99

## 设计阶段
1. 简化系统设计
        不要过早的进行服务化拆分
2. 尽可能了解系统全局和数据指标 -> 上周的数据
3. 选择合适的组件 性能，稳定性，适配行，社区熟悉度，项目活跃度
4. 规范设计，接口设计形成文档
## 研发阶段
1. 容错设计 + 重试
    重试放大 A->B->C
    c有问题，b重试三次返回a,a又回重试3次 放大 9次
    限制重试 -> b告诉a,我已经重试，你不需要重试了
2. code review
3. 幂等
    a. 乐观锁 -> where total = 100 的时候才给他+50
    b. 去重表 -> 唯一数据写入到表
    c. 全局唯一性检查 -> 生成全局唯一ID
## 部署
变更 = 故障
规范上线时间
1. 上线时间，频率 周五不上线 ，6点之前上线
2. 完整的checklist 和必要的业务开关，非常重要！！！
3. 上线周知和观察
4. 预热和慢启动 -> JIT -> 慢慢放量
灰度发布
1. 按照服务池灰度
2. 按照策略放量
## 容量评估
1. 确定流量来源和目标值
2. 梳理链路资源和服务情况
3. 监控+ 全链路压测
4. 确定水位
5. 确定机器数量和资源数量
## 压力测试
1. 真实数据 -> 线上流量copy -> mock服务 -> 影子存储 -> 不影响线上数据
2. 流量标记
3. 压测报告
## 如何减少故障发生
1. 冗余 
    同步复制 -> mysql -> 所有主同写完
    半同步复制 -> kafka -> isr
    异步复制 -> redis
2. CDN冗余

## 负载均衡
1. 轮询
2. 加权轮询
3. 待地址/urlhash
4. JSQ -> client 标记后端节点的请求数量 -> client 视角看，对于全局可能不是

## 节点容错
1. 故障转移
2. 节点检测

