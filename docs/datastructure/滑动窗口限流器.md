

## Redis 深度历险

```java
public class SimpleRateLimiter {
    public boolean isActionAllowed(String userId,action, int period, int max) {
        String key = String.format("hist:%s:%s",userId, action);
        long now = System.currentTimeMillis();
        Pipline pipe = jedis.piplined();
        pipe.multil();
        pip.zadd(key, now, ""+now);
        pipe.zremRangeByScore(key, now, now-perid *1000);
        Response<Long>count = pipe.zcard();
        pipe.expire(key, pe+1);
        pip.exec();
        pipe.close();
        return count.get()<= maxCount;
    }
}
```
## redis
scan 0 match key*99 count 100
1010
0111
redis 还可以有专门的bigkey命令，6
